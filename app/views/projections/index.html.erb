<h1>Projections</h1>
<script>
nv.addGraph(function() {
  var chart = nv.models.scatterChart()
                .showDistX(true)
                .showDistY(true)
                .color(d3.scale.category10().range())
                .forceY([5])
                .forceX([0]);

  chart.xAxis.tickFormat(d3.format('.02f'));
  chart.yAxis.tickFormat(d3.format('.02f'));


  d3.select('#chart svg')
    .datum([{key: 'Projected Interest Rate', values: <%= raw @chart_data.to_json %>}])
    .transition().duration(500)
      .call(chart);

  nv.utils.windowResize(chart.update);

  return chart;

});

</script>

<style>
  #chart svg {
    height: 400px;
  }
</style>

<div id="chart">
  <svg></svg>
</div>

<%= form_tag({controller: 'projections', action: 'index'}, method: 'get', id: 'trim_form') do %>
  <%= label_tag(:trim, "Trim outliers from each projection set. Projection set = projections made on one date about the Fed funds rate on an individual future date.") %>
  <%= select_tag(:trim, options_for_select([0,1,2,3,4,5,6,7], params.has_key?(:trim) ? params[:trim].to_i : 0)) %>
<% end %>

<script>
  document.getElementById('trim').addEventListener('change', function() {
    document.getElementById('trim_form').submit();
  }, false)
</script>
